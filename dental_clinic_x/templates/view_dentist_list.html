{% extends "base_generic.html" %}

{% block content %}
<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">Dentist list</h1>
    </div>
    <!-- /.col-lg-12 -->
</div>
<!-- /.row -->
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-body">
                <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
                    <thead>
                        <tr>
                            {% if user.dentalclinicuser.is_admin %}
                            <th>Username</th>
                            {% endif %}
                            <th>First name</th>
                            <th>Last name</th>
                            <th>Created time</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if dentists %}
                        {% for dentist in dentists %}
                        <tr class="dentist">
                            <input type="hidden" value="{{ dentist.id }}"/>
                            {% if user.dentalclinicuser.is_admin %}
                            <td>{{ dentist.user.username}}</td>
                            {% endif %}
                            <td>{{ dentist.user.first_name }}</td>
                            <td>{{ dentist.user.last_name }}</td>
                            <td>
                              {{ dentist.created_time }}
                              {% if user.dentalclinicuser.is_admin %}
                              <form action="{% url 'dental_clinic_x:delete_dentist_profile' %}" method="POST">
                                {% csrf_token %}
                                <input type="hidden" name="dentist_id" value="{{ dentist.id }}"/>
                                <button type="button" class="btn btn-danger delete_dentist_profile" style="float: right;">Delete</button>
                              </form>
                              {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                        {% endif %}
                    </tbody>
                </table>
                <!-- /.table-responsive -->
            </div>
            <!-- /.panel-body -->
        </div>
        <!-- /.panel -->
    </div>
    <!-- /.col-lg-12 -->
</div>
<!-- /.row -->

<script>
  $(document).ready(function() {
    $('#dataTables-example').DataTable({
        {# responsive: true #}
    });

    $("tr.dentist").click(function(e) {
      e.preventDefault();

      var dentist_id = $(this).children("input[type='hidden']").val();
      window.location.replace("{% url 'dental_clinic_x:view_dentist' dentist_id='12345' %}".replace("12345", dentist_id));

      return false;
    });

    $("button.delete_dentist_profile").click(function(e) {
      e.preventDefault();

      if (confirm("Are you sure?") == true) {
        $(this).parent().trigger("submit");
      }

      return false;
    });
  });
</script>

{% endblock %}

